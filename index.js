"use strict";
module.exports = (function () {
    function CDBUrl(json) {
        this.json = json;
        if (json.protocol && json.port) {
            this.protocol = json.protocol;
            this.port = json.port;
        }
        else if (!json.protocol && !json.port) {
            this.protocol = "http";
            this.port = 80;
        }
        else if (!json.protocol && json.port && json.port === 80) {
            this.protocol = "http";
            this.port = json.port;
        }
        else if (json.protocol && json.protocol === "http" && !json.port) {
            this.port = 80;
            this.protocol = json.protocol;
        }
        else if (!json.protocol && json.port && json.port === 443) {
            this.protocol = "https";
            this.port = json.port;
        }
        else if (json.protocol && json.protocol === "https" && !json.port) {
            this.port = 443;
            this.protocol = json.protocol;
        }
        else if (json.protocol) {
            throw Error("invalid protocol");
        }
        else if (json.port) {
            throw Error("invalid port");
        }
        if (json.hostname) {
            this.hostname = json.hostname;
        }
        else {
            throw Error("no hostname specified");
        }
        if (this.protocol === "https" && this.port === 443) {
            this.host = this.hostname;
            this.publink = this.protocol + "://" + this.hostname;
        }
        else if (this.protocol === "http" && this.port === 80) {
            this.host = this.hostname;
            this.publink = this.protocol + "://" + this.hostname;
        }
        else {
            this.host = this.hostname + ":" + this.port;
            this.publink = this.protocol + "://" + this.hostname + ":" + this.port;
        }
        if (json.user && json.password) {
            this.user = json.user;
            this.password = json.password;
            this.auth = this.user + ":" + this.password;
            if (this.protocol === "https" && this.port === 443) {
                this.mylink = this.protocol + "://" + this.auth + "@" + this.hostname;
            }
            else if (this.protocol === "http" && this.port === 80) {
                this.mylink = this.protocol + "://" + this.auth + "@" + this.hostname;
            }
            else {
                this.mylink = this.protocol + "://" + this.auth + "@" + this.hostname + ":" + this.port;
            }
            if (json.db) {
                this.mydb = this.mylink + "/" + json.db;
            }
        }
        if (json.db) {
            this.db = json.db;
            this.pubdb = this.publink + "/" + this.db;
        }
    }
    CDBUrl.prototype.my = function (db) {
        if (this.mylink) {
            return this.mylink + "/" + db;
        }
        else {
            throw Error("require authorized user");
        }
    };
    ;
    CDBUrl.prototype.for = function (user, password, db) {
        if (db) {
            return this.protocol + "://" + user + ":" + password + "@" + this.host + "/" + db;
        }
        else {
            return this.protocol + "://" + user + ":" + password + "@" + this.host;
        }
    };
    ;
    return CDBUrl;
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwibXkiLCJmb3IiXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQVliLGlCQUFTO0lBY0wsZ0JBQW1CLElBQWdCO1FBQWhCQSxTQUFJQSxHQUFKQSxJQUFJQSxDQUFZQTtRQUUvQkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsSUFBSUEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDN0JBLElBQUlBLENBQUNBLFFBQVFBLEdBQUdBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBO1lBQzlCQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDdENBLElBQUlBLENBQUNBLFFBQVFBLEdBQUdBLE1BQU1BLENBQUNBO1lBQ3ZCQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxFQUFFQSxDQUFDQTtRQUNuQkEsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsSUFBSUEsSUFBSUEsQ0FBQ0EsSUFBSUEsSUFBSUEsSUFBSUEsQ0FBQ0EsSUFBSUEsS0FBS0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDekRBLElBQUlBLENBQUNBLFFBQVFBLEdBQUdBLE1BQU1BLENBQUNBO1lBQ3ZCQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsSUFBSUEsSUFBSUEsQ0FBQ0EsUUFBUUEsS0FBS0EsTUFBTUEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDakVBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLEVBQUVBLENBQUNBO1lBQ2ZBLElBQUlBLENBQUNBLFFBQVFBLEdBQUdBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBO1FBQ2xDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxJQUFJQSxJQUFJQSxDQUFDQSxJQUFJQSxJQUFJQSxJQUFJQSxDQUFDQSxJQUFJQSxLQUFLQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUMxREEsSUFBSUEsQ0FBQ0EsUUFBUUEsR0FBR0EsT0FBT0EsQ0FBQ0E7WUFDeEJBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLElBQUlBLENBQUNBO1FBQzFCQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxJQUFJQSxJQUFJQSxDQUFDQSxRQUFRQSxLQUFLQSxPQUFPQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNsRUEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsR0FBR0EsQ0FBQ0E7WUFDaEJBLElBQUlBLENBQUNBLFFBQVFBLEdBQUdBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBO1FBQ2xDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN2QkEsTUFBTUEsS0FBS0EsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxDQUFDQTtRQUNwQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDbkJBLE1BQU1BLEtBQUtBLENBQUNBLGNBQWNBLENBQUNBLENBQUNBO1FBQ2hDQSxDQUFDQTtRQUVEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNoQkEsSUFBSUEsQ0FBQ0EsUUFBUUEsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7UUFDbENBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ0pBLE1BQU1BLEtBQUtBLENBQUNBLHVCQUF1QkEsQ0FBQ0EsQ0FBQ0E7UUFDekNBLENBQUNBO1FBRURBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFFBQVFBLEtBQUtBLE9BQU9BLElBQUlBLElBQUlBLENBQUNBLElBQUlBLEtBQUtBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO1lBQ2pEQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQTtZQUMxQkEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsR0FBR0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7UUFDekRBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFFBQVFBLEtBQUtBLE1BQU1BLElBQUlBLElBQUlBLENBQUNBLElBQUlBLEtBQUtBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO1lBQ3REQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQTtZQUMxQkEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsR0FBR0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7UUFDekRBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ0pBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLFFBQVFBLEdBQUdBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLElBQUlBLENBQUNBO1lBQzVDQSxJQUFJQSxDQUFDQSxPQUFPQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTtRQUMzRUEsQ0FBQ0E7UUFFREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsSUFBSUEsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDN0JBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLElBQUlBLENBQUNBO1lBQ3RCQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQTtZQUM5QkEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7WUFDNUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFFBQVFBLEtBQUtBLE9BQU9BLElBQUlBLElBQUlBLENBQUNBLElBQUlBLEtBQUtBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO2dCQUNqREEsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsR0FBR0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7WUFDMUVBLENBQUNBO1lBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFFBQVFBLEtBQUtBLE1BQU1BLElBQUlBLElBQUlBLENBQUNBLElBQUlBLEtBQUtBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO2dCQUN0REEsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsR0FBR0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7WUFDMUVBLENBQUNBO1lBQUNBLElBQUlBLENBQUNBLENBQUNBO2dCQUNKQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTtZQUM1RkEsQ0FBQ0E7WUFDREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ1ZBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLEdBQUdBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBO1lBQzVDQSxDQUFDQTtRQUNMQSxDQUFDQTtRQUdEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNWQSxJQUFJQSxDQUFDQSxFQUFFQSxHQUFHQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQTtZQUNsQkEsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7UUFDOUNBLENBQUNBO0lBQ0xBLENBQUNBO0lBRUQsbUJBQUUsR0FBRixVQUFHLEVBQVU7UUFFVEMsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDZEEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsR0FBR0EsR0FBR0EsRUFBRUEsQ0FBQ0E7UUFDbENBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ0pBLE1BQU1BLEtBQUtBLENBQUNBLHlCQUF5QkEsQ0FBQ0EsQ0FBQ0E7UUFDM0NBLENBQUNBO0lBRUxBLENBQUNBOztJQUVELG9CQUFHLEdBQUgsVUFBSSxJQUFZLEVBQUUsUUFBZ0IsRUFBRSxFQUFXO1FBRTNDQyxFQUFFQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNMQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxHQUFHQSxHQUFHQSxHQUFHQSxRQUFRQSxHQUFHQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxHQUFHQSxHQUFHQSxFQUFFQSxDQUFDQTtRQUN0RkEsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDSkEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsR0FBR0EsS0FBS0EsR0FBR0EsSUFBSUEsR0FBR0EsR0FBR0EsR0FBR0EsUUFBUUEsR0FBR0EsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7UUFDM0VBLENBQUNBO0lBRUxBLENBQUNBOztJQUdMLGFBQUM7QUFBRCxDQXJHUyxBQXFHUixHQUFBLENBQUMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuXG5pbnRlcmZhY2UgSUNsYXNzQ29uZiB7XG4gICAgaG9zdG5hbWU6IHN0cmluZztcbiAgICBwcm90b2NvbD86IHN0cmluZztcbiAgICBwb3J0PzogbnVtYmVyO1xuICAgIGRiPzogc3RyaW5nO1xuICAgIHVzZXI/OiBzdHJpbmc7XG4gICAgcGFzc3dvcmQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCA9IGNsYXNzIENEQlVybCBpbXBsZW1lbnRzIElDbGFzc0NvbmYge1xuICAgIHB1Ymxpbms6IHN0cmluZztcbiAgICBwcm90b2NvbDogc3RyaW5nO1xuICAgIHBvcnQ6IG51bWJlcjtcbiAgICBob3N0OiBzdHJpbmc7XG4gICAgaG9zdG5hbWU6IHN0cmluZztcbiAgICBhdXRoOiBzdHJpbmc7XG4gICAgZGI6IHN0cmluZztcbiAgICBwdWJkYjogc3RyaW5nO1xuICAgIG15bGluazogc3RyaW5nO1xuICAgIG15ZGI6IHN0cmluZztcbiAgICB1c2VyOiBzdHJpbmc7XG4gICAgcGFzc3dvcmQ6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBqc29uOiBJQ2xhc3NDb25mKSB7XG5cbiAgICAgICAgaWYgKGpzb24ucHJvdG9jb2wgJiYganNvbi5wb3J0KSB7XG4gICAgICAgICAgICB0aGlzLnByb3RvY29sID0ganNvbi5wcm90b2NvbDtcbiAgICAgICAgICAgIHRoaXMucG9ydCA9IGpzb24ucG9ydDtcbiAgICAgICAgfSBlbHNlIGlmICghanNvbi5wcm90b2NvbCAmJiAhanNvbi5wb3J0KSB7XG4gICAgICAgICAgICB0aGlzLnByb3RvY29sID0gXCJodHRwXCI7XG4gICAgICAgICAgICB0aGlzLnBvcnQgPSA4MDtcbiAgICAgICAgfSBlbHNlIGlmICghanNvbi5wcm90b2NvbCAmJiBqc29uLnBvcnQgJiYganNvbi5wb3J0ID09PSA4MCkge1xuICAgICAgICAgICAgdGhpcy5wcm90b2NvbCA9IFwiaHR0cFwiO1xuICAgICAgICAgICAgdGhpcy5wb3J0ID0ganNvbi5wb3J0O1xuICAgICAgICB9IGVsc2UgaWYgKGpzb24ucHJvdG9jb2wgJiYganNvbi5wcm90b2NvbCA9PT0gXCJodHRwXCIgJiYgIWpzb24ucG9ydCkge1xuICAgICAgICAgICAgdGhpcy5wb3J0ID0gODA7XG4gICAgICAgICAgICB0aGlzLnByb3RvY29sID0ganNvbi5wcm90b2NvbDtcbiAgICAgICAgfSBlbHNlIGlmICghanNvbi5wcm90b2NvbCAmJiBqc29uLnBvcnQgJiYganNvbi5wb3J0ID09PSA0NDMpIHtcbiAgICAgICAgICAgIHRoaXMucHJvdG9jb2wgPSBcImh0dHBzXCI7XG4gICAgICAgICAgICB0aGlzLnBvcnQgPSBqc29uLnBvcnQ7XG4gICAgICAgIH0gZWxzZSBpZiAoanNvbi5wcm90b2NvbCAmJiBqc29uLnByb3RvY29sID09PSBcImh0dHBzXCIgJiYgIWpzb24ucG9ydCkge1xuICAgICAgICAgICAgdGhpcy5wb3J0ID0gNDQzO1xuICAgICAgICAgICAgdGhpcy5wcm90b2NvbCA9IGpzb24ucHJvdG9jb2w7XG4gICAgICAgIH0gZWxzZSBpZiAoanNvbi5wcm90b2NvbCkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJpbnZhbGlkIHByb3RvY29sXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKGpzb24ucG9ydCkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJpbnZhbGlkIHBvcnRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoanNvbi5ob3N0bmFtZSkge1xuICAgICAgICAgICAgdGhpcy5ob3N0bmFtZSA9IGpzb24uaG9zdG5hbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIm5vIGhvc3RuYW1lIHNwZWNpZmllZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3RvY29sID09PSBcImh0dHBzXCIgJiYgdGhpcy5wb3J0ID09PSA0NDMpIHtcbiAgICAgICAgICAgIHRoaXMuaG9zdCA9IHRoaXMuaG9zdG5hbWU7XG4gICAgICAgICAgICB0aGlzLnB1YmxpbmsgPSB0aGlzLnByb3RvY29sICsgXCI6Ly9cIiArIHRoaXMuaG9zdG5hbWU7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm90b2NvbCA9PT0gXCJodHRwXCIgJiYgdGhpcy5wb3J0ID09PSA4MCkge1xuICAgICAgICAgICAgdGhpcy5ob3N0ID0gdGhpcy5ob3N0bmFtZTtcbiAgICAgICAgICAgIHRoaXMucHVibGluayA9IHRoaXMucHJvdG9jb2wgKyBcIjovL1wiICsgdGhpcy5ob3N0bmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaG9zdCA9IHRoaXMuaG9zdG5hbWUgKyBcIjpcIiArIHRoaXMucG9ydDtcbiAgICAgICAgICAgIHRoaXMucHVibGluayA9IHRoaXMucHJvdG9jb2wgKyBcIjovL1wiICsgdGhpcy5ob3N0bmFtZSArIFwiOlwiICsgdGhpcy5wb3J0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGpzb24udXNlciAmJiBqc29uLnBhc3N3b3JkKSB7XG4gICAgICAgICAgICB0aGlzLnVzZXIgPSBqc29uLnVzZXI7XG4gICAgICAgICAgICB0aGlzLnBhc3N3b3JkID0ganNvbi5wYXNzd29yZDtcbiAgICAgICAgICAgIHRoaXMuYXV0aCA9IHRoaXMudXNlciArIFwiOlwiICsgdGhpcy5wYXNzd29yZDtcbiAgICAgICAgICAgIGlmICh0aGlzLnByb3RvY29sID09PSBcImh0dHBzXCIgJiYgdGhpcy5wb3J0ID09PSA0NDMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm15bGluayA9IHRoaXMucHJvdG9jb2wgKyBcIjovL1wiICsgdGhpcy5hdXRoICsgXCJAXCIgKyB0aGlzLmhvc3RuYW1lO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3RvY29sID09PSBcImh0dHBcIiAmJiB0aGlzLnBvcnQgPT09IDgwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5teWxpbmsgPSB0aGlzLnByb3RvY29sICsgXCI6Ly9cIiArIHRoaXMuYXV0aCArIFwiQFwiICsgdGhpcy5ob3N0bmFtZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5teWxpbmsgPSB0aGlzLnByb3RvY29sICsgXCI6Ly9cIiArIHRoaXMuYXV0aCArIFwiQFwiICsgdGhpcy5ob3N0bmFtZSArIFwiOlwiICsgdGhpcy5wb3J0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGpzb24uZGIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm15ZGIgPSB0aGlzLm15bGluayArIFwiL1wiICsganNvbi5kYjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgaWYgKGpzb24uZGIpIHtcbiAgICAgICAgICAgIHRoaXMuZGIgPSBqc29uLmRiO1xuICAgICAgICAgICAgdGhpcy5wdWJkYiA9IHRoaXMucHVibGluayArIFwiL1wiICsgdGhpcy5kYjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG15KGRiOiBzdHJpbmcpOiBzdHJpbmcge1xuXG4gICAgICAgIGlmICh0aGlzLm15bGluaykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubXlsaW5rICsgXCIvXCIgKyBkYjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicmVxdWlyZSBhdXRob3JpemVkIHVzZXJcIik7XG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICBmb3IodXNlcjogc3RyaW5nLCBwYXNzd29yZDogc3RyaW5nLCBkYj86IHN0cmluZyk6IHN0cmluZyB7XG5cbiAgICAgICAgaWYgKGRiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm90b2NvbCArIFwiOi8vXCIgKyB1c2VyICsgXCI6XCIgKyBwYXNzd29yZCArIFwiQFwiICsgdGhpcy5ob3N0ICsgXCIvXCIgKyBkYjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3RvY29sICsgXCI6Ly9cIiArIHVzZXIgKyBcIjpcIiArIHBhc3N3b3JkICsgXCJAXCIgKyB0aGlzLmhvc3Q7XG4gICAgICAgIH1cblxuICAgIH07XG5cblxufTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
