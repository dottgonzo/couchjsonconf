"use strict";
var couchJsonConf = (function () {
    function couchJsonConf(json) {
        this.json = json;
        if (json.protocol && json.port) {
            this.protocol = json.protocol;
            this.port = json.port;
        }
        else if (!json.protocol && !json.port) {
            this.protocol = "http";
            this.port = 80;
        }
        else if (!json.protocol && json.port && json.port === 80) {
            this.protocol = "http";
            this.port = json.port;
        }
        else if (json.protocol && json.protocol === "http" && !json.port) {
            this.port = 80;
            this.protocol = json.protocol;
        }
        else if (!json.protocol && json.port && json.port === 443) {
            this.protocol = "https";
            this.port = json.port;
        }
        else if (json.protocol && json.protocol === "https" && !json.port) {
            this.port = 443;
            this.protocol = json.protocol;
        }
        else if (json.protocol) {
            throw Error("invalid protocol");
        }
        else if (json.port) {
            throw Error("invalid port");
        }
        if (json.hostname) {
            this.hostname = json.hostname;
        }
        else {
            throw Error("no hostname specified");
        }
        if (this.protocol === "https" && this.port === 443) {
            this.host = this.hostname;
            this.publink = this.protocol + "://" + this.hostname;
        }
        else if (this.protocol === "http" && this.port === 80) {
            this.host = this.hostname;
            this.publink = this.protocol + "://" + this.hostname;
        }
        else {
            this.host = this.hostname + ":" + this.port;
            this.publink = this.protocol + "://" + this.hostname + ":" + this.port;
        }
        if (json.user && json.password) {
            this.user = json.user;
            this.password = json.password;
            this.auth = this.user + ":" + this.password;
            if (this.protocol === "https" && this.port === 443) {
                this.mylink = this.protocol + "://" + this.auth + "@" + this.hostname;
            }
            else if (this.protocol === "http" && this.port === 80) {
                this.mylink = this.protocol + "://" + this.auth + "@" + this.hostname;
            }
            else {
                this.mylink = this.protocol + "://" + this.auth + "@" + this.hostname + ":" + this.port;
            }
            if (json.db) {
                this.mydb = this.mylink + "/" + json.db;
            }
        }
        if (json.db) {
            this.db = json.db;
            this.pubdb = this.publink + "/" + this.db;
        }
    }
    couchJsonConf.prototype.my = function (db) {
        if (this.mylink) {
            return this.mylink + "/" + db;
        }
        else {
            throw Error("require authorized user");
        }
    };
    ;
    couchJsonConf.prototype.for = function (user, password, db) {
        if (db) {
            return this.protocol + "://" + user + ":" + password + "@" + this.host + "/" + db;
        }
        else {
            return this.protocol + "://" + user + ":" + password + "@" + this.host;
        }
    };
    ;
    return couchJsonConf;
}());
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = couchJsonConf;
;

//# sourceMappingURL=data:application/json;base64,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RyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1lBQzFFLENBQUM7WUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsS0FBSyxNQUFNLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUN0RCxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7WUFDMUUsQ0FBQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNKLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLFFBQVEsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztZQUM1RixDQUFDO1lBQ0QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ1YsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQzVDLENBQUM7UUFDTCxDQUFDO1FBR0QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDVixJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDbEIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsT0FBTyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQzlDLENBQUM7SUFDTCxDQUFDO0lBRUQsMEJBQUUsR0FBRixVQUFHLEVBQVU7UUFFVCxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztZQUNkLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDbEMsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osTUFBTSxLQUFLLENBQUMseUJBQXlCLENBQUMsQ0FBQztRQUMzQyxDQUFDO0lBRUwsQ0FBQzs7SUFFRCwyQkFBRyxHQUFILFVBQUksSUFBWSxFQUFFLFFBQWdCLEVBQUUsRUFBVztRQUUzQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ0wsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSyxHQUFHLElBQUksR0FBRyxHQUFHLEdBQUcsUUFBUSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDdEYsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSyxHQUFHLElBQUksR0FBRyxHQUFHLEdBQUcsUUFBUSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQzNFLENBQUM7SUFFTCxDQUFDOztJQUVMLG9CQUFDO0FBQUQsQ0FwR0EsQUFvR0MsSUFBQTtBQXBHRDsrQkFvR0MsQ0FBQTtBQUFBLENBQUMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgSUNsYXNzQ29uZiB7XG4gICAgaG9zdG5hbWU6IHN0cmluZztcbiAgICBwcm90b2NvbD86IHN0cmluZztcbiAgICBwb3J0PzogbnVtYmVyO1xuICAgIGRiPzogc3RyaW5nO1xuICAgIHVzZXI/OiBzdHJpbmc7XG4gICAgcGFzc3dvcmQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGNvdWNoSnNvbkNvbmYgaW1wbGVtZW50cyBJQ2xhc3NDb25mIHtcbiAgICBwdWJsaW5rOiBzdHJpbmc7XG4gICAgcHJvdG9jb2w6IHN0cmluZztcbiAgICBwb3J0OiBudW1iZXI7XG4gICAgaG9zdDogc3RyaW5nO1xuICAgIGhvc3RuYW1lOiBzdHJpbmc7XG4gICAgYXV0aDogc3RyaW5nO1xuICAgIGRiOiBzdHJpbmc7XG4gICAgcHViZGI6IHN0cmluZztcbiAgICBteWxpbms6IHN0cmluZztcbiAgICBteWRiOiBzdHJpbmc7XG4gICAgdXNlcjogc3RyaW5nO1xuICAgIHBhc3N3b3JkOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMganNvbjogSUNsYXNzQ29uZikge1xuXG4gICAgICAgIGlmIChqc29uLnByb3RvY29sICYmIGpzb24ucG9ydCkge1xuICAgICAgICAgICAgdGhpcy5wcm90b2NvbCA9IGpzb24ucHJvdG9jb2w7XG4gICAgICAgICAgICB0aGlzLnBvcnQgPSBqc29uLnBvcnQ7XG4gICAgICAgIH0gZWxzZSBpZiAoIWpzb24ucHJvdG9jb2wgJiYgIWpzb24ucG9ydCkge1xuICAgICAgICAgICAgdGhpcy5wcm90b2NvbCA9IFwiaHR0cFwiO1xuICAgICAgICAgICAgdGhpcy5wb3J0ID0gODA7XG4gICAgICAgIH0gZWxzZSBpZiAoIWpzb24ucHJvdG9jb2wgJiYganNvbi5wb3J0ICYmIGpzb24ucG9ydCA9PT0gODApIHtcbiAgICAgICAgICAgIHRoaXMucHJvdG9jb2wgPSBcImh0dHBcIjtcbiAgICAgICAgICAgIHRoaXMucG9ydCA9IGpzb24ucG9ydDtcbiAgICAgICAgfSBlbHNlIGlmIChqc29uLnByb3RvY29sICYmIGpzb24ucHJvdG9jb2wgPT09IFwiaHR0cFwiICYmICFqc29uLnBvcnQpIHtcbiAgICAgICAgICAgIHRoaXMucG9ydCA9IDgwO1xuICAgICAgICAgICAgdGhpcy5wcm90b2NvbCA9IGpzb24ucHJvdG9jb2w7XG4gICAgICAgIH0gZWxzZSBpZiAoIWpzb24ucHJvdG9jb2wgJiYganNvbi5wb3J0ICYmIGpzb24ucG9ydCA9PT0gNDQzKSB7XG4gICAgICAgICAgICB0aGlzLnByb3RvY29sID0gXCJodHRwc1wiO1xuICAgICAgICAgICAgdGhpcy5wb3J0ID0ganNvbi5wb3J0O1xuICAgICAgICB9IGVsc2UgaWYgKGpzb24ucHJvdG9jb2wgJiYganNvbi5wcm90b2NvbCA9PT0gXCJodHRwc1wiICYmICFqc29uLnBvcnQpIHtcbiAgICAgICAgICAgIHRoaXMucG9ydCA9IDQ0MztcbiAgICAgICAgICAgIHRoaXMucHJvdG9jb2wgPSBqc29uLnByb3RvY29sO1xuICAgICAgICB9IGVsc2UgaWYgKGpzb24ucHJvdG9jb2wpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiaW52YWxpZCBwcm90b2NvbFwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChqc29uLnBvcnQpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiaW52YWxpZCBwb3J0XCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGpzb24uaG9zdG5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuaG9zdG5hbWUgPSBqc29uLmhvc3RuYW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJubyBob3N0bmFtZSBzcGVjaWZpZWRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5wcm90b2NvbCA9PT0gXCJodHRwc1wiICYmIHRoaXMucG9ydCA9PT0gNDQzKSB7XG4gICAgICAgICAgICB0aGlzLmhvc3QgPSB0aGlzLmhvc3RuYW1lO1xuICAgICAgICAgICAgdGhpcy5wdWJsaW5rID0gdGhpcy5wcm90b2NvbCArIFwiOi8vXCIgKyB0aGlzLmhvc3RuYW1lO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvdG9jb2wgPT09IFwiaHR0cFwiICYmIHRoaXMucG9ydCA9PT0gODApIHtcbiAgICAgICAgICAgIHRoaXMuaG9zdCA9IHRoaXMuaG9zdG5hbWU7XG4gICAgICAgICAgICB0aGlzLnB1YmxpbmsgPSB0aGlzLnByb3RvY29sICsgXCI6Ly9cIiArIHRoaXMuaG9zdG5hbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhvc3QgPSB0aGlzLmhvc3RuYW1lICsgXCI6XCIgKyB0aGlzLnBvcnQ7XG4gICAgICAgICAgICB0aGlzLnB1YmxpbmsgPSB0aGlzLnByb3RvY29sICsgXCI6Ly9cIiArIHRoaXMuaG9zdG5hbWUgKyBcIjpcIiArIHRoaXMucG9ydDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChqc29uLnVzZXIgJiYganNvbi5wYXNzd29yZCkge1xuICAgICAgICAgICAgdGhpcy51c2VyID0ganNvbi51c2VyO1xuICAgICAgICAgICAgdGhpcy5wYXNzd29yZCA9IGpzb24ucGFzc3dvcmQ7XG4gICAgICAgICAgICB0aGlzLmF1dGggPSB0aGlzLnVzZXIgKyBcIjpcIiArIHRoaXMucGFzc3dvcmQ7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm90b2NvbCA9PT0gXCJodHRwc1wiICYmIHRoaXMucG9ydCA9PT0gNDQzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5teWxpbmsgPSB0aGlzLnByb3RvY29sICsgXCI6Ly9cIiArIHRoaXMuYXV0aCArIFwiQFwiICsgdGhpcy5ob3N0bmFtZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm90b2NvbCA9PT0gXCJodHRwXCIgJiYgdGhpcy5wb3J0ID09PSA4MCkge1xuICAgICAgICAgICAgICAgIHRoaXMubXlsaW5rID0gdGhpcy5wcm90b2NvbCArIFwiOi8vXCIgKyB0aGlzLmF1dGggKyBcIkBcIiArIHRoaXMuaG9zdG5hbWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubXlsaW5rID0gdGhpcy5wcm90b2NvbCArIFwiOi8vXCIgKyB0aGlzLmF1dGggKyBcIkBcIiArIHRoaXMuaG9zdG5hbWUgKyBcIjpcIiArIHRoaXMucG9ydDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChqc29uLmRiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5teWRiID0gdGhpcy5teWxpbmsgKyBcIi9cIiArIGpzb24uZGI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIGlmIChqc29uLmRiKSB7XG4gICAgICAgICAgICB0aGlzLmRiID0ganNvbi5kYjtcbiAgICAgICAgICAgIHRoaXMucHViZGIgPSB0aGlzLnB1YmxpbmsgKyBcIi9cIiArIHRoaXMuZGI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBteShkYjogc3RyaW5nKTogc3RyaW5nIHtcblxuICAgICAgICBpZiAodGhpcy5teWxpbmspIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm15bGluayArIFwiL1wiICsgZGI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInJlcXVpcmUgYXV0aG9yaXplZCB1c2VyXCIpO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgZm9yKHVzZXI6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZywgZGI/OiBzdHJpbmcpOiBzdHJpbmcge1xuXG4gICAgICAgIGlmIChkYikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvdG9jb2wgKyBcIjovL1wiICsgdXNlciArIFwiOlwiICsgcGFzc3dvcmQgKyBcIkBcIiArIHRoaXMuaG9zdCArIFwiL1wiICsgZGI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm90b2NvbCArIFwiOi8vXCIgKyB1c2VyICsgXCI6XCIgKyBwYXNzd29yZCArIFwiQFwiICsgdGhpcy5ob3N0O1xuICAgICAgICB9XG5cbiAgICB9O1xuXG59OyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
